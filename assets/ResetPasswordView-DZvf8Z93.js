import{d as y,r as t,aA as h,n as b,c as r,o,a as d,K as i,V as f,J as _,aj as k,O as g}from"./vue-BqyYyVhM.js";import{s as c}from"./index-ChIKHqJ_.js";import"./elementPlus-tPvvSRko.js";const M={class:"min-h-screen flex items-center justify-center bg-gray-100 dark:bg-gray-900"},V={class:"w-full max-w-sm p-8 bg-white dark:bg-gray-800 rounded shadow"},R=["disabled"],S={key:1,class:"text-center text-gray-600 dark:text-gray-300"},B={key:2,class:"text-red-500 text-sm text-center mt-4"},P={key:3,class:"text-green-500 text-sm text-center mt-4"},N=y({__name:"ResetPasswordView",setup(T){const l=t(""),u=t(!1),s=t(""),n=t(""),p=t(!1),m=t(!1),v=h();b(async()=>{const{data:a,error:e}=await c.auth.getSession();if(!a.session||e){s.value="重設連結無效或已過期，請重新請求重設信件。",setTimeout(()=>{v.push("/forget-password")},3e3);return}m.value=!0});const w=async()=>{u.value=!0,s.value="",n.value="";const{error:a}=await c.auth.updateUser({password:l.value});a?s.value=a.message:(p.value=!0,n.value="密碼更新成功，請重新登入...",await c.auth.signOut(),setTimeout(()=>{v.push("/login")},2e3)),u.value=!1};return(a,e)=>(o(),r("div",M,[d("div",V,[e[1]||(e[1]=d("h2",{class:"text-2xl font-bold text-center text-gray-800 dark:text-white mb-6"}," 重設密碼 ",-1)),!p.value&&!u.value&&m.value?(o(),r("form",{key:0,onSubmit:f(w,["prevent"]),class:"space-y-4"},[_(d("input",{"onUpdate:modelValue":e[0]||(e[0]=x=>l.value=x),type:"password",placeholder:"輸入新密碼",autocomplete:"new-password",class:"w-full px-4 py-2 border rounded bg-white dark:bg-gray-700 text-black dark:text-white placeholder-gray-400"},null,512),[[k,l.value]]),d("button",{type:"submit",disabled:!l.value,class:"w-full py-2 px-4 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50"}," 更新密碼 ",8,R)],32)):i("",!0),u.value?(o(),r("p",S," 更新中... ")):i("",!0),s.value?(o(),r("p",B,g(s.value),1)):i("",!0),n.value?(o(),r("p",P,g(n.value),1)):i("",!0)])]))}});export{N as default};
